"use strict";(self.webpackChunksession=self.webpackChunksession||[]).push([[156],{156:function(e,s,a){a.r(s),a.d(s,{default:function(){return h}});var r=a(4165),o=a(5861),n=a(9439),l=a(2791),t={width:"AccountSettings_width__z0v-A",blueInput:"AccountSettings_blueInput__jFfIE",redInput:"AccountSettings_redInput__cicpb"},d=a(1243),i=a(5705),c=a(6727),u=a(5218),m=a(4270),p=a(184);function h(){var e=(0,l.useState)({createdAt:"",email:"",name:"",_id:""}),s=(0,n.Z)(e,2),a=(s[0],s[1]),h=(0,l.useState)(!1),v=(0,n.Z)(h,2),b=v[0],w=v[1],f=(0,l.useState)("fa-eye"),g=(0,n.Z)(f,2),x=g[0],j=g[1],N=(0,l.useState)(!1),P=(0,n.Z)(N,2),y=P[0],Z=P[1],S=(0,l.useState)(null),k=(0,n.Z)(S,2),C=(k[0],k[1]),I=(0,l.useState)("d-none"),_=(0,n.Z)(I,2),q=(_[0],_[1],(0,l.useState)("Update personal information")),A=(0,n.Z)(q,2),B=A[0],F=(A[1],(0,l.useState)("disabled")),E=(0,n.Z)(F,2),T=(E[0],E[1],{token:localStorage.getItem("userToken")}),U=c.Ry({name:c.Z_().required("Name is required").min(3,"min 3 charcters").max(15,"maximum 15 charcters"),email:c.Z_().email("Invalid Email").required("Email is required"),phone:c.Z_().required("Phone is required").matches(/^01[0125][0-9]{8}$/,"Invalid Phone")}),M=c.Ry({currentPassword:c.Z_().matches(/^[A-Z][a-z0-9]{3,8}$/,"Invalid Password").required("current Password is required"),password:c.Z_().matches(/^[A-Z][a-z0-9]{3,8}$/,"Invalid Password").required("Password is required"),rePassword:c.Z_().required("Password is required").oneOf([c.iH("password")],"RePassword must match password")}),O=(0,i.TA)({initialValues:{name:"",email:"",phone:""},validationSchema:U,onSubmit:function(e){return function(e){return V.apply(this,arguments)}(e)}}),R=(0,i.TA)({initialValues:{currentPassword:"",password:"",rePassword:""},validationSchema2:M,onSubmit:function(e){return function(e){return z.apply(this,arguments)}(e)}});function V(){return(V=(0,o.Z)((0,r.Z)().mark((function e(s){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z(!0),e.next=3,d.Z.put("https://route-ecommerce.onrender.com/api/v1/users/updateMe/",{name:s.name,email:s.email,phone:s.phone},{headers:T}).catch((function(e){Z(!1),console.log(e),u.ZP.error(e.response.data.errors.msg,{duration:3e3,position:"top-right",style:{background:"black",color:"white"}}),C(e.response.data.message)}));case 3:a=e.sent,console.log(a),"success"===(null===a||void 0===a?void 0:a.message)&&(u.ZP.success(a.message,{duration:3e3,position:"top-right",style:{background:"black",color:"white"}}),Z(!1));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=(0,o.Z)((0,r.Z)().mark((function e(s){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z(!0),e.next=3,d.Z.put("https://route-ecommerce.onrender.com/api/v1/users/changeMyPassword",{currentPassword:s.currentPassword,password:s.password,rePassword:s.rePassword},{headers:T}).catch((function(e){var s,a,r,o,n,l,t,d,i;if(Z(!1),console.log(e),400==(null===e||void 0===e||null===(s=e.response)||void 0===s?void 0:s.status)&&C(null===e||void 0===e||null===(a=e.response)||void 0===a||null===(r=a.data)||void 0===r||null===(o=r.errors)||void 0===o?void 0:o.msg),400===(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status))C(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(d=t.data)||void 0===d||null===(i=d.errors)||void 0===i?void 0:i.msg),u.ZP.error(e.response.data.errors.msg,{duration:3e3,position:"top-right",style:{background:"black",color:"white"}});else if(401===(null===e||void 0===e||null===(l=e.response)||void 0===l?void 0:l.status)){var c,m;C(null===e||void 0===e||null===(c=e.response)||void 0===c?void 0:c.data.message),u.ZP.error(null===e||void 0===e||null===(m=e.response)||void 0===m?void 0:m.data.message,{duration:3e3,position:"top-right",style:{background:"black",color:"white"}})}}));case 3:a=e.sent,console.log("updateLoggedUserPassword response",a),"success"===a.data.message&&(console.log("response.data.message",a.data.message),u.ZP.success(a.data.message,{duration:3e3,position:"top-right",style:{background:"black",color:"white"}}),Z(!1));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=(0,o.Z)((0,r.Z)().mark((function e(){var s,o,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=localStorage.getItem("mail"),e.next=3,d.Z.get("https://ecommerce.routemisr.com/api/v1/users?email=".concat(s)).catch((function(e){console.log("err",e)}));case 3:o=e.sent,n=o.data,a(n.users[0]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,l.useEffect)((function(){!function(){$.apply(this,arguments)}()})),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(m.q,{children:[(0,p.jsx)("meta",{charSet:"utf-8"}),(0,p.jsx)("title",{children:"Account settings"})]}),(0,p.jsx)("div",{className:"container",children:(0,p.jsxs)("div",{className:"row py-5",children:[(0,p.jsx)("h2",{className:"ps-3 mb-5",children:"Account settings"}),(0,p.jsxs)("div",{className:"accordion accordion-flush",id:"accordionFlushExample",children:[(0,p.jsxs)("div",{className:"accordion-item",children:[(0,p.jsx)("h2",{className:"accordion-header",children:(0,p.jsx)("button",{className:"accordion-button collapsed h5",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne","aria-expanded":"false","aria-controls":"flush-collapseOne",children:"Update personal information"})}),(0,p.jsx)("div",{id:"flush-collapseOne",className:"accordion-collapse collapse","data-bs-parent":"#accordionFlushExample",children:(0,p.jsx)("div",{className:"accordion-body",children:(0,p.jsx)("form",{onSubmit:O.handleSubmit,children:(0,p.jsxs)("div",{className:"row mb-5",children:[(0,p.jsxs)("div",{className:"form-group  col-md-6",children:[(0,p.jsx)("input",{type:"text",className:"form-control mb-3 py-2 ".concat(t.blueInput," rounded-pill"),placeholder:"Your Name",id:"name",name:"name",value:O.values.name,onChange:O.handleChange,onBlur:O.handleBlur}),(0,p.jsx)("label",{htmlFor:"name",className:"fw-semibold",children:"Your name"}),O.errors.name&&O.touched.name?(0,p.jsx)("div",{className:"alert alert-danger",children:O.errors.name}):""]}),(0,p.jsxs)("div",{className:"form-group  col-md-6",children:[(0,p.jsx)("input",{type:"email",className:"form-control mb-3 py-2 ".concat(t.blueInput," rounded-pill"),placeholder:"Email Address",id:"email",name:"email",value:O.values.email,onChange:O.handleChange,onBlur:O.handleBlur}),(0,p.jsx)("label",{htmlFor:"email",className:"fw-semibold",children:"Email Address"}),O.errors.email&&O.touched.email?(0,p.jsx)("div",{className:"alert alert-danger",children:O.errors.email}):""]}),(0,p.jsxs)("div",{className:"form-group col-md-6",children:[(0,p.jsx)("input",{type:"tel",className:"form-control mb-3 py-2 ".concat(t.blueInput," rounded-pill"),placeholder:"Mobile number",id:"phone",name:"phone",value:O.values.phone,onChange:O.handleChange,onBlur:O.handleBlur}),(0,p.jsx)("label",{htmlFor:"phone",className:"fw-semibold",children:"Mobile number"}),O.errors.phone&&O.touched.phone?(0,p.jsx)("div",{className:"alert alert-danger",children:O.errors.phone}):""]}),(0,p.jsx)("div",{className:"col-md-6 d-flex justify-content-center",children:y?(0,p.jsx)("button",{className:"".concat(t.button," rounded-pill  mb-3"),type:"submit",children:(0,p.jsx)("i",{className:"fa fa-spinner fa-spin"})}):(0,p.jsx)("button",{disabled:!O.isValid&&O.dirty,className:"rounded-pill mb-3 bg-prim",type:"submit",children:B})})]})})})})]}),(0,p.jsxs)("div",{className:"accordion-item",children:[(0,p.jsx)("h2",{className:"accordion-header",children:(0,p.jsx)("button",{className:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseTwo","aria-expanded":"false","aria-controls":"flush-collapseTwo",children:"Update password"})}),(0,p.jsx)("div",{id:"flush-collapseTwo",className:"accordion-collapse collapse","data-bs-parent":"#accordionFlushExample",children:(0,p.jsx)("div",{className:"accordion-body",children:(0,p.jsxs)("form",{onSubmit:R.handleSubmit,children:[(0,p.jsxs)("div",{className:"form-group position-relative",children:[(0,p.jsx)("input",{type:b?"text":"password",className:"form-control mb-3 py-2 ".concat(t.redInput," rounded-pill"),placeholder:" Current Password",id:"currentPassword",name:"currentPassword",value:R.values.currentPassword,onChange:R.handleChange,onBlur:R.handleBlur}),(0,p.jsx)("label",{htmlFor:"currentPassword",className:"fw-semibold",children:"    Current Password"}),(0,p.jsx)("i",{className:"far ".concat(x," cursor-pointer position-absolute"),id:"togglePassword",onClick:function(){!0===b?(w(!1),j("fa-eye")):(w(!0),j("fa-eye-slash"))}})]}),R.errors.currentPassword&&R.touched.currentPassword?(0,p.jsx)("div",{className:"alert alert-danger",children:R.errors.currentPassword}):"",(0,p.jsxs)("div",{className:"form-group position-relative",children:[(0,p.jsx)("input",{type:b?"text":"password",className:"form-control mb-3 py-2 ".concat(t.redInput,"  rounded-pill rounded-pill"),placeholder:"Password",id:"password",name:"password",value:R.values.password,onChange:R.handleChange,onBlur:R.handleBlur}),(0,p.jsx)("label",{htmlFor:"password",className:"fw-semibold",children:"Password"})]}),R.errors.password&&R.touched.password?(0,p.jsx)("div",{className:"alert alert-danger",children:R.errors.password}):"",(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("input",{type:b?"text":"password",className:"form-control mb-3 py-2 ".concat(t.redInput,"  rounded-pill"),placeholder:"rePassword",id:"rePassword",name:"rePassword",value:R.values.rePassword,onChange:R.handleChange,onBlur:R.handleBlur}),(0,p.jsx)("label",{htmlFor:"rePassword",className:"fw-semibold ",children:"Re-enter password"})]}),R.errors.rePassword&&R.touched.rePassword?(0,p.jsx)("div",{className:"alert alert-danger",children:R.errors.rePassword}):"",(0,p.jsx)("div",{className:"d-flex justify-content-center",children:y?(0,p.jsx)("button",{className:"".concat(t.button," btn w-100 mb-3"),type:"submit",children:(0,p.jsx)("i",{className:"fa fa-spinner fa-spin"})}):(0,p.jsx)("button",{disabled:!R.isValid&&R.dirty,className:"btn  mx-auto mb-3 bg-prim rounded-pill",type:"submit",children:"Update Password"})})]})})})]})]})]})})]})}}}]);
//# sourceMappingURL=156.cc384162.chunk.js.map